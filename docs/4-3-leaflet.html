<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:title" content="4.3 Leaflet | Data Visualization in R" />
<meta property="og:type" content="book" />


<meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
<meta name="github-repo" content="rstudio/bookdown-demo" />

<meta name="author" content="Brooke Anderson" />

<meta name="date" content="2019-03-28" />


<meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook.">

<title>4.3 Leaflet | Data Visualization in R</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/jquery-1.12.4/jquery.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.2/leaflet.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="toc.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#prerequisites"><span class="toc-section-number">1</span> Prerequisites</a></li>
<li class="has-sub"><a href="2-plot.html#plot"><span class="toc-section-number">2</span> Plot</a><ul>
<li class="has-sub"><a href="2-1-plot-elements.html#plot-elements"><span class="toc-section-number">2.1</span> Plot elements</a><ul>
<li><a href="2-1-plot-elements.html#example-data"><span class="toc-section-number">2.1.1</span> Example data</a></li>
<li><a href="2-1-plot-elements.html#illustrating-plot-elements"><span class="toc-section-number">2.1.2</span> Illustrating plot elements</a></li>
</ul></li>
<li class="has-sub"><a href="2-2-building-a-plot.html#building-a-plot"><span class="toc-section-number">2.2</span> Building a plot</a><ul>
<li><a href="2-2-building-a-plot.html#reading-data"><span class="toc-section-number">2.2.1</span> Reading data</a></li>
<li><a href="2-2-building-a-plot.html#plotting-by-layers"><span class="toc-section-number">2.2.2</span> Plotting by layers</a></li>
</ul></li>
<li><a href="2-3-saving-plots.html#saving-plots"><span class="toc-section-number">2.3</span> Saving plots</a></li>
<li><a href="2-4-learn-more.html#learn-more"><span class="toc-section-number">2.4</span> Learn more</a></li>
</ul></li>
<li class="has-sub"><a href="3-map.html#map"><span class="toc-section-number">3</span> Map</a><ul>
<li><a href="3-1-geographical-data-in-a-tidy-format.html#geographical-data-in-a-tidy-format"><span class="toc-section-number">3.1</span> Geographical data in a tidy format</a></li>
<li><a href="3-2-basic-mapping.html#basic-mapping"><span class="toc-section-number">3.2</span> Basic mapping</a></li>
<li><a href="3-3-learn-more-1.html#learn-more-1"><span class="toc-section-number">3.3</span> Learn more</a></li>
</ul></li>
<li class="has-sub"><a href="4-interact.html#interact"><span class="toc-section-number">4</span> Interact</a><ul>
<li><a href="4-1-dt-datatables.html#dt-datatables"><span class="toc-section-number">4.1</span> DT: Datatables</a></li>
<li><a href="4-2-plotly.html#plotly"><span class="toc-section-number">4.2</span> Plotly</a></li>
<li><a href="4-3-leaflet.html#leaflet"><span class="toc-section-number">4.3</span> Leaflet</a></li>
<li><a href="4-4-learn-more-2.html#learn-more-2"><span class="toc-section-number">4.4</span> Learn more</a></li>
</ul></li>
<li class="has-sub"><a href="5-report.html#report"><span class="toc-section-number">5</span> Report</a><ul>
<li><a href="5-1-rmarkdown.html#rmarkdown"><span class="toc-section-number">5.1</span> RMarkdown</a></li>
<li><a href="5-2-dashboards.html#dashboards"><span class="toc-section-number">5.2</span> Dashboards</a></li>
<li><a href="5-3-learn-more-3.html#learn-more-3"><span class="toc-section-number">5.3</span> Learn more</a></li>
</ul></li>
<li class="has-sub"><a href="6-tidy.html#tidy"><span class="toc-section-number">6</span> Tidy</a><ul>
<li><a href="6-1-tidyverse-tools.html#tidyverse-tools"><span class="toc-section-number">6.1</span> Tidyverse tools</a></li>
<li><a href="6-2-tidying-example.html#tidying-example"><span class="toc-section-number">6.2</span> Tidying example</a></li>
<li><a href="6-3-learn-more-4.html#learn-more-4"><span class="toc-section-number">6.3</span> Learn more</a></li>
</ul></li>
<li><a href="7-final-words.html#final-words"><span class="toc-section-number">7</span> Final Words</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="leaflet" class="section level2">
<h2><span class="header-section-number">4.3</span> Leaflet</h2>
<p>One of my favorite packages for interactive plotting in R is the <code>leaflet</code> package <span class="citation">(Cheng, Karambelkar, and Xie <label for="tufte-mn-11" class="margin-toggle">&#8853;</label><input type="checkbox" id="tufte-mn-11" class="margin-toggle">2018<span class="marginnote">Cheng, Joe, Bhaskar Karambelkar, and Yihui Xie. 2018. <em>Leaflet: Create Interactive Web Maps with the Javascript ’Leaflet’ Library</em>. <a href="https://CRAN.R-project.org/package=leaflet">https://CRAN.R-project.org/package=leaflet</a>.</span>)</span>.
This package allows you to create interactive maps very similar to the maps you see on Google maps.
As the background, it pulls in tiles from a collection of tiles at different zoom levels, allowing
you to zoom in and out and pan around the resulting map.</p>
<p>You can create a <code>leaflet</code> map using data that’s in an <code>sf</code> class, which we covered in the “Map”
section. For example, you can use the following code to read in the data, convert it to an <code>sf</code>
object by specifying the columns with geographical information, and set projection information
using the <code>st_sf</code> function:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;sf&quot;</span>)

fl_accidents <span class="op">%&lt;&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">st_as_sf</span>(<span class="dt">coords =</span> <span class="kw">c</span>(<span class="st">&quot;longitud&quot;</span>, <span class="st">&quot;latitude&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">st_sf</span>(<span class="dt">crs =</span> <span class="dv">4326</span>)</code></pre>
<p>Now you can create the map with the data. The code should look similar to <code>ggplot2</code> code for
plotting, although notice that it uses a pipe operator (<code>%&gt;%</code>) rather than a plus sign (<code>+</code>) to
add on the layers. The <code>leaflet</code> call creates a leaflet object, and the <code>addTiles</code> function adds in
the background tiles.<label for="tufte-sn-28" class="margin-toggle sidenote-number">28</label><input type="checkbox" id="tufte-sn-28" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">28</span> In this example, we’re using the default background tiles. You can pick from
a variety of styles for background tiles, however. See the online documentation for <code>leaflet</code>,
listed later in this section, for more.</span> You can add markers showing the location of each accident
using the <code>addMarkers</code> call, specifying the dataset to use with the <code>data</code> parameter:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;leaflet&quot;</span>)
<span class="kw">leaflet</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addMarkers</span>(<span class="dt">data =</span> fl_accidents)</code></pre>
<div id="htmlwidget-04cd6945dd8a5dd0c985" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-04cd6945dd8a5dd0c985">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[30.2474,28.51796389,28.26148889,28.573275,30.22845833,30.56341111,30.13608333,29.56196111,30.06197778,30.37913056,30.39993056,30.15676389,27.51623056,29.02606944,28.30813056,27.48831389,30.42301667,28.19993889,28.32404444,25.86673889,27.39658056,27.58978611,26.48524167,26.5089,28.13113056,30.38643889,27.58766944,28.52425,28.01073333,30.10211944,25.6876,28.36670833,29.02935,30.16451111,28.34871111,28.15358333,30.65893611],[-81.5407,-81.41926667,-81.34221111,-81.18188056,-81.84293889,-87.3797,-82.71024444,-82.87318056,-85.25815,-81.76085556,-81.74076111,-85.6355,-80.44788889,-82.12029444,-82.66615,-81.76585556,-84.24898333,-82.64678889,-82.69583889,-80.32331944,-82.56328611,-82.24605833,-81.94330278,-81.95595,-81.07623056,-84.71040278,-82.4255,-82.49176111,-81.75111111,-81.72336944,-80.34971111,-82.69068889,-82.0448,-81.74728611,-81.49691667,-80.58482778,-86.87985833],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[25.6876,30.65893611],"lng":[-87.3797,-80.32331944]}},"evals":[],"jsHooks":[]}</script>
<p>The result is an interactive map, with a marker at the location of each accident. Try using the
plus and minus buttons to zoom in and out, and click on the map to pan around the map.</p>
<p>There is a lot you can do to make the map more interesting. For example, you can add another layer
to the map with the track of Hurricane Irma. You can read that track in from a shapefile using
<code>st_read</code>, as described in the “Map” section, transforming the projection to map the projection
of the accident data using <code>st_transform</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">irma_track &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/al112017_best_track&quot;</span>, 
                      <span class="dt">layer =</span> <span class="st">&quot;al112017_lin&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">st_transform</span>(<span class="dt">crs =</span> <span class="dv">4326</span>)</code></pre>
<pre><code>## Reading layer `al112017_lin&#39; from data source `/Users/georgianaanderson/Documents/r_workshops/navy_public_health/data/al112017_best_track&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 20 features and 3 fields
## geometry type:  LINESTRING
## dimension:      XY
## bbox:           xmin: -90.1 ymin: 16.1 xmax: -26.9 ymax: 36.8
## epsg (SRID):    NA
## proj4string:    +proj=longlat +a=6371200 +b=6371200 +no_defs</code></pre>
<p>This spatial object is a type known as a “polyline”, so you can add it to the <code>leaflet</code> map with a
layer called with <code>addPolylines</code>. In this example, I’ve made the line red with the option
<code>color = "red"</code>. The <code>leaflet</code> plot will automatically zoom to fit the data you’re plotting—since
the hurricane started in the tropics and went past Florida, its range is much larger than Florida.
To have the <code>leaflet</code> plot still open zoomed in to Florida, you can use the <code>fitBounds</code> call to
specify the opening view of the map. Finally, with the call <code>popup = ~ date</code>, we’re specifying that
the each marker should show the date of the accident when you click on it.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">leaflet</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">fitBounds</span>(<span class="dt">lng1 =</span> <span class="dv">-88</span>, <span class="dt">lng2 =</span> <span class="dv">-80</span>, <span class="dt">lat1 =</span> <span class="fl">24.5</span>, <span class="dt">lat2 =</span> <span class="fl">31.5</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addMarkers</span>(<span class="dt">data =</span> fl_accidents,
             <span class="dt">popup =</span> <span class="op">~</span><span class="st"> </span>date) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addPolylines</span>(<span class="dt">data =</span> irma_track, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<div id="htmlwidget-8ee140f9cf353842e388" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-8ee140f9cf353842e388">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[30.2474,28.51796389,28.26148889,28.573275,30.22845833,30.56341111,30.13608333,29.56196111,30.06197778,30.37913056,30.39993056,30.15676389,27.51623056,29.02606944,28.30813056,27.48831389,30.42301667,28.19993889,28.32404444,25.86673889,27.39658056,27.58978611,26.48524167,26.5089,28.13113056,30.38643889,27.58766944,28.52425,28.01073333,30.10211944,25.6876,28.36670833,29.02935,30.16451111,28.34871111,28.15358333,30.65893611],[-81.5407,-81.41926667,-81.34221111,-81.18188056,-81.84293889,-87.3797,-82.71024444,-82.87318056,-85.25815,-81.76085556,-81.74076111,-85.6355,-80.44788889,-82.12029444,-82.66615,-81.76585556,-84.24898333,-82.64678889,-82.69583889,-80.32331944,-82.56328611,-82.24605833,-81.94330278,-81.95595,-81.07623056,-84.71040278,-82.4255,-82.49176111,-81.75111111,-81.72336944,-80.34971111,-82.69068889,-82.0448,-81.74728611,-81.49691667,-80.58482778,-86.87985833],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["2017-09-08","2017-09-07","2017-09-08","2017-09-07","2017-09-08","2017-09-07","2017-09-10","2017-09-08","2017-09-09","2017-09-12","2017-09-07","2017-09-10","2017-09-11","2017-09-12","2017-09-07","2017-09-10","2017-09-08","2017-09-07","2017-09-10","2017-09-11","2017-09-08","2017-09-08","2017-09-13","2017-09-07","2017-09-07","2017-09-09","2017-09-12","2017-09-09","2017-09-11","2017-09-11","2017-09-07","2017-09-07","2017-09-12","2017-09-12","2017-09-10","2017-09-07","2017-09-13"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[-26.8999996185303,-28.2999992370605],"lat":[16.1000003814697,16.2000007629395]}]],[[{"lng":[-28.2999992370605,-29.7000007629394,-30.7999992370605,-31.7000007629395,-32.5],"lat":[16.2000007629395,16.2999992370605,16.2999992370605,16.2999992370605,16.3999996185303]}]],[[{"lng":[-32.5,-33.4000015258789,-34.2000007629395],"lat":[16.3999996185303,16.7000007629395,17.1000003814697]}]],[[{"lng":[-34.2000007629395,-35.0999984741211],"lat":[17.1000003814697,17.5]}]],[[{"lng":[-35.0999984741211,-36.0999984741211,-37.2999992370605,-38.5,-39.7000007629394,-41.0999984741211,-42.5999984741211],"lat":[17.5,17.8999996185303,18.3999996185303,18.7999992370605,19.1000003814697,19.1000003814697,18.8999996185303]}]],[[{"lng":[-42.5999984741211,-44.0999984741211,-45.5,-46.7000007629395,-47.9000015258789],"lat":[18.8999996185303,18.7000007629395,18.5,18.2000007629395,17.8999996185303]}]],[[{"lng":[-47.9000015258789,-49.2000007629395,-50.4000015258789,-51.5,-52.5999984741211,-53.9000015258789],"lat":[17.8999996185303,17.6000003814697,17.2999992370605,17,16.7999992370605,16.7000007629395]}]],[[{"lng":[-53.9000015258789,-55.0999984741211,-56.4000015258789,-57.7999992370605],"lat":[16.7000007629395,16.6000003814697,16.6000003814697,16.7000007629395]}]],[[{"lng":[-57.7999992370605,-59.2000007629395,-60.5999984741211,-61.7999992370605,-61.9000015258789,-63.0999984741211,-63.2999992370605,-64.4000015258789,-64.6999969482422,-66.1999969482422,-67.5999984741211,-69,-70.4000015258789,-71.8000030517578,-73],"lat":[16.7000007629395,16.8999996185303,17.2999992370605,17.7000007629395,17.7000007629395,18.1000003814697,18.1000003814697,18.5,18.6000003814697,19.2000007629395,19.7000007629394,20.2000007629395,20.7000007629395,21.1000003814697,21.5]}]],[[{"lng":[-73,-73.1999969482422,-74.6999969482422,-76],"lat":[21.5,21.5,21.7999992370605,22]}]],[[{"lng":[-76,-77.1999969482422,-77.9000015258789,-78.3000030517578],"lat":[22,22.1000003814697,22.2999992370605,22.3999996185303]}]],[[{"lng":[-78.3000030517578,-79.3000030517578],"lat":[22.3999996185303,22.7000007629394]}]],[[{"lng":[-79.3000030517578,-80.1999969482422],"lat":[22.7000007629394,23.1000003814697]}]],[[{"lng":[-80.1999969482422,-80.9000015258789],"lat":[23.1000003814697,23.3999996185303]}]],[[{"lng":[-80.9000015258789,-81.3000030517578],"lat":[23.3999996185303,23.7000007629395]}]],[[{"lng":[-81.3000030517578,-81.5,-81.5,-81.6999969482422],"lat":[23.7000007629395,24.5,24.7000007629395,25.6000003814697]}]],[[{"lng":[-81.6999969482422,-81.6999969482422,-81.6999969482422],"lat":[25.6000003814697,25.8999996185303,26.7999992370605]}]],[[{"lng":[-81.6999969482422,-82.1999969482422,-82.6999969482422],"lat":[26.7999992370605,28.2000007629394,29.6000003814697]}]],[[{"lng":[-82.6999969482422,-83.5,-84.4000015258789,-85.5999984741211],"lat":[29.6000003814697,30.8999996185303,31.8999996185303,32.9000015258789]}]],[[{"lng":[-85.5999984741211,-86.9000015258789,-88.0999984741211,-88.9000015258789,-89.5,-90.0999984741211],"lat":[32.9000015258789,33.7999992370605,34.7999992370605,35.5999984741211,36.2000007629395,36.7999992370605]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"red","weight":5,"opacity":0.5,"fill":false,"fillColor":"red","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"fitBounds":[24.5,-88,31.5,-80,[]],"limits":{"lat":[16.1000003814697,36.7999992370605],"lng":[-90.0999984741211,-26.8999996185303]}},"evals":[],"jsHooks":[]}</script>
<p>The “pop-ups” for the markers can be developed to be pretty fancy. You can use <code>paste</code> to paste
together elements from the data with other words to create nice labels. You can also format these, using
HTML formating.<label for="tufte-sn-29" class="margin-toggle sidenote-number">29</label><input type="checkbox" id="tufte-sn-29" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">29</span> With HTML formatting, you use special tags to specify formatting like bold font
or weblinks. For example, to write “<strong>bold</strong> is in bold” with HTML, you would write
“<code>&lt;b&gt;bold&lt;b&gt; is in bold</code>”.</span></p>
<p>Try this out in the following code. After you run this, the <code>leaflet</code> map should have pop-ups that
give both the date and the number of the fatalities, on separate lines (the <code>&lt;br&gt;</code> creates a line
break). First, add a column to <code>fl_accidents</code> called <code>popup</code>, with the full (HTML formatted) text
you want to include in the labels. Then, in the <code>addMarkers</code> call, specify that this column should
be used for the pop-up with <code>popup = ~ popup</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">fl_accidents <span class="op">%&lt;&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">popup =</span> <span class="kw">paste</span>(<span class="st">&quot;&lt;b&gt;Date:&lt;/b&gt;&quot;</span>, date, 
                       <span class="st">&quot;&lt;br/&gt;&quot;</span>,
                       <span class="st">&quot;&lt;b&gt;# fatalities:&lt;/b&gt;&quot;</span>, fatals))

<span class="kw">leaflet</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addTiles</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">fitBounds</span>(<span class="dt">lng1 =</span> <span class="dv">-88</span>, <span class="dt">lng2 =</span> <span class="dv">-80</span>, <span class="dt">lat1 =</span> <span class="fl">24.5</span>, <span class="dt">lat2 =</span> <span class="fl">31.5</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addMarkers</span>(<span class="dt">data =</span> fl_accidents,
             <span class="dt">popup =</span> <span class="op">~</span><span class="st"> </span>popup) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">addPolylines</span>(<span class="dt">data =</span> irma_track, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre>
<div id="htmlwidget-9be6a87e3c6651e9e526" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-9be6a87e3c6651e9e526">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[[30.2474,28.51796389,28.26148889,28.573275,30.22845833,30.56341111,30.13608333,29.56196111,30.06197778,30.37913056,30.39993056,30.15676389,27.51623056,29.02606944,28.30813056,27.48831389,30.42301667,28.19993889,28.32404444,25.86673889,27.39658056,27.58978611,26.48524167,26.5089,28.13113056,30.38643889,27.58766944,28.52425,28.01073333,30.10211944,25.6876,28.36670833,29.02935,30.16451111,28.34871111,28.15358333,30.65893611],[-81.5407,-81.41926667,-81.34221111,-81.18188056,-81.84293889,-87.3797,-82.71024444,-82.87318056,-85.25815,-81.76085556,-81.74076111,-85.6355,-80.44788889,-82.12029444,-82.66615,-81.76585556,-84.24898333,-82.64678889,-82.69583889,-80.32331944,-82.56328611,-82.24605833,-81.94330278,-81.95595,-81.07623056,-84.71040278,-82.4255,-82.49176111,-81.75111111,-81.72336944,-80.34971111,-82.69068889,-82.0448,-81.74728611,-81.49691667,-80.58482778,-86.87985833],null,null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<b>Date:<\/b> 2017-09-08 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-08 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-08 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 2","<b>Date:<\/b> 2017-09-10 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-08 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-09 <br/> <b># fatalities:<\/b> 2","<b>Date:<\/b> 2017-09-12 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-10 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-11 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-12 <br/> <b># fatalities:<\/b> 2","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-10 <br/> <b># fatalities:<\/b> 2","<b>Date:<\/b> 2017-09-08 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-10 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-11 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-08 <br/> <b># fatalities:<\/b> 2","<b>Date:<\/b> 2017-09-08 <br/> <b># fatalities:<\/b> 2","<b>Date:<\/b> 2017-09-13 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-09 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-12 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-09 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-11 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-11 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-12 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-12 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-10 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-07 <br/> <b># fatalities:<\/b> 1","<b>Date:<\/b> 2017-09-13 <br/> <b># fatalities:<\/b> 1"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addPolylines","args":[[[[{"lng":[-26.8999996185303,-28.2999992370605],"lat":[16.1000003814697,16.2000007629395]}]],[[{"lng":[-28.2999992370605,-29.7000007629394,-30.7999992370605,-31.7000007629395,-32.5],"lat":[16.2000007629395,16.2999992370605,16.2999992370605,16.2999992370605,16.3999996185303]}]],[[{"lng":[-32.5,-33.4000015258789,-34.2000007629395],"lat":[16.3999996185303,16.7000007629395,17.1000003814697]}]],[[{"lng":[-34.2000007629395,-35.0999984741211],"lat":[17.1000003814697,17.5]}]],[[{"lng":[-35.0999984741211,-36.0999984741211,-37.2999992370605,-38.5,-39.7000007629394,-41.0999984741211,-42.5999984741211],"lat":[17.5,17.8999996185303,18.3999996185303,18.7999992370605,19.1000003814697,19.1000003814697,18.8999996185303]}]],[[{"lng":[-42.5999984741211,-44.0999984741211,-45.5,-46.7000007629395,-47.9000015258789],"lat":[18.8999996185303,18.7000007629395,18.5,18.2000007629395,17.8999996185303]}]],[[{"lng":[-47.9000015258789,-49.2000007629395,-50.4000015258789,-51.5,-52.5999984741211,-53.9000015258789],"lat":[17.8999996185303,17.6000003814697,17.2999992370605,17,16.7999992370605,16.7000007629395]}]],[[{"lng":[-53.9000015258789,-55.0999984741211,-56.4000015258789,-57.7999992370605],"lat":[16.7000007629395,16.6000003814697,16.6000003814697,16.7000007629395]}]],[[{"lng":[-57.7999992370605,-59.2000007629395,-60.5999984741211,-61.7999992370605,-61.9000015258789,-63.0999984741211,-63.2999992370605,-64.4000015258789,-64.6999969482422,-66.1999969482422,-67.5999984741211,-69,-70.4000015258789,-71.8000030517578,-73],"lat":[16.7000007629395,16.8999996185303,17.2999992370605,17.7000007629395,17.7000007629395,18.1000003814697,18.1000003814697,18.5,18.6000003814697,19.2000007629395,19.7000007629394,20.2000007629395,20.7000007629395,21.1000003814697,21.5]}]],[[{"lng":[-73,-73.1999969482422,-74.6999969482422,-76],"lat":[21.5,21.5,21.7999992370605,22]}]],[[{"lng":[-76,-77.1999969482422,-77.9000015258789,-78.3000030517578],"lat":[22,22.1000003814697,22.2999992370605,22.3999996185303]}]],[[{"lng":[-78.3000030517578,-79.3000030517578],"lat":[22.3999996185303,22.7000007629394]}]],[[{"lng":[-79.3000030517578,-80.1999969482422],"lat":[22.7000007629394,23.1000003814697]}]],[[{"lng":[-80.1999969482422,-80.9000015258789],"lat":[23.1000003814697,23.3999996185303]}]],[[{"lng":[-80.9000015258789,-81.3000030517578],"lat":[23.3999996185303,23.7000007629395]}]],[[{"lng":[-81.3000030517578,-81.5,-81.5,-81.6999969482422],"lat":[23.7000007629395,24.5,24.7000007629395,25.6000003814697]}]],[[{"lng":[-81.6999969482422,-81.6999969482422,-81.6999969482422],"lat":[25.6000003814697,25.8999996185303,26.7999992370605]}]],[[{"lng":[-81.6999969482422,-82.1999969482422,-82.6999969482422],"lat":[26.7999992370605,28.2000007629394,29.6000003814697]}]],[[{"lng":[-82.6999969482422,-83.5,-84.4000015258789,-85.5999984741211],"lat":[29.6000003814697,30.8999996185303,31.8999996185303,32.9000015258789]}]],[[{"lng":[-85.5999984741211,-86.9000015258789,-88.0999984741211,-88.9000015258789,-89.5,-90.0999984741211],"lat":[32.9000015258789,33.7999992370605,34.7999992370605,35.5999984741211,36.2000007629395,36.7999992370605]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"red","weight":5,"opacity":0.5,"fill":false,"fillColor":"red","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"fitBounds":[24.5,-88,31.5,-80,[]],"limits":{"lat":[16.1000003814697,36.7999992370605],"lng":[-90.0999984741211,-26.8999996185303]}},"evals":[],"jsHooks":[]}</script>
<p>The <code>leaflet</code> package has extensive <a href="https://rstudio.github.io/leaflet/">online documentation</a>.
Browse through the sections of this online documentation to get a lot more ideas of how you can
create and customize interesting interactive maps with R.</p>
</div>
<p style="text-align: center;">
<a href="4-2-plotly.html"><button class="btn btn-default">Previous</button></a>
<a href="4-4-learn-more-2.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>



</body>
</html>
